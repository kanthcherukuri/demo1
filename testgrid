public class gridlastic {

	private RemoteWebDriver driver;

	@BeforeMethod(alwaysRun = true)
	public void beforeMethod() throws Exception {

		// Example test environment. NOTE: Gridlastic auto scaling requires all
		// these 3 environment variables in each request.
		// see test environments for capabilities to use https://www.gridlastic.com/test-environments.html
		String platform_name = "win7";
		String browser_name = "chrome";
		String browser_version = "latest";

		// optional video recording
		String record_video = "True";

		DesiredCapabilities capabilities = new DesiredCapabilities();
		if (platform_name.equalsIgnoreCase("win7")) {
			capabilities.setPlatform(Platform.VISTA);
		}
		if (platform_name.equalsIgnoreCase("win8")) {
			capabilities.setPlatform(Platform.WIN8);
		}
		if (platform_name.equalsIgnoreCase("win8_1")) {
			capabilities.setPlatform(Platform.WIN8_1);
		}
		if (platform_name.equalsIgnoreCase("win10")) {
			capabilities.setPlatform(Platform.WIN10);
		}
		if (platform_name.equalsIgnoreCase("linux")) {
			capabilities.setPlatform(Platform.LINUX);
		}
		capabilities.setBrowserName(browser_name);
		capabilities.setVersion(browser_version);

		// video record
		if (record_video.equalsIgnoreCase("True")) {
			capabilities.setCapability("video", "True"); // NOTE: "True" is a case sensitive string, not boolean.
		} else {
			capabilities.setCapability("video", "False"); // NOTE: "False" is a case sensitive string, not boolean.
		}
		
		//Chrome specifics
		if (browser_name.equalsIgnoreCase("chrome")){
			ChromeOptions options = new ChromeOptions();
			options.addArguments("disable-infobars"); // starting from Chrome 57 the info bar displays with "Chrome is being controlled by automated test software."
			// On Linux start-maximized does not expand browser window to max screen size. Always set a window size and window position.
			if (platform_name.equalsIgnoreCase("linux")) {
				options.addArguments(Arrays.asList("--window-position=0,0"));	 		
				options.addArguments(Arrays.asList("--window-size=1920,1080"));	
				} else {
				options.addArguments(Arrays.asList("--start-maximized"));
				}
			capabilities.setCapability(ChromeOptions.CAPABILITY, options);
			} 
		
		//Firefox specifics
		if (browser_name.equalsIgnoreCase("firefox")){
				// If you are using selenium 3 and test Firefox versions below version 48
				if(Integer.parseInt(browser_version)<48){
				capabilities.setCapability("marionette", false);
				}
		}

		driver = new RemoteWebDriver(new URL("http://LXmv6u8SAjnrb2Q1uMMFoTgQlyx9Ihyj:5KF15EKvNXMPQtGb6iGl2M1dbpdJwBSr@8SZRFXF6.gridlastic.com:80/wd/hub"),capabilities);
		driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
		
		// On LINUX/FIREFOX the "driver.manage().window().maximize()" option does not expand browser window to max screen size. Always set a window size.
		if (platform_name.equalsIgnoreCase("linux") && browser_name.equalsIgnoreCase("firefox")) {
			driver.manage().window().setSize(new Dimension(1920, 1080));	
		}
        

		if (record_video.equalsIgnoreCase("True")) {
			System.out.println("Test Video: " + "http://s3-ap-south-1.amazonaws.com/97a7h79-h6f9-85d1-9435-r2367763uct4/f714e237-9d3b-ecf6-8000-0f0cb59c6046/play.html?" + ((RemoteWebDriver) driver).getSessionId());
		}
	}

	@Test(enabled = true)
	 public void test_site() throws Exception  { 	
        driver.get("https://zoyloqa.zoylo.com/login");
        System.out.println("Logged the url");
        driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
        System.out.println("Waiting to Load the page");
        driver.findElement(By.id("emailAddress")).sendKeys("honeytestdg@gmail.com");
        System.out.println("Entered username");
		driver.findElement(By.id("password")).sendKeys("Zoylo@666");	
		 System.out.println("Entered Password");
		driver.findElement(By.xpath("//button[text()='Login']")).click();
		 System.out.println("Clicked on Login Button");
        Thread.sleep(10000); //slow down for demo purposes
        System.out.println("Test Video: " + "http://s3-ap-south-1.amazonaws.com/97a7h79-h6f9-85d1-9435-r2367763uct4/f714e237-9d3b-ecf6-8000-0f0cb59c6046/play.html?" + ((RemoteWebDriver) driver).getSessionId());
	}

	@AfterMethod(alwaysRun = true)
	public void tearDown() throws Exception {
		driver.quit();
	}

}
